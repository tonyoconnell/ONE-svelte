import{b as ke,e as Oe,i as Ne,a as fe}from"./forms.256d3e1b.js";import{p as ne}from"./stores.332d1960.js";import{d as Y,w as L}from"./singletons.fa4d4adc.js";import{_ as g,a5 as ge,a6 as Ee}from"./index.e5838562.js";import{U as Se,N as Me,P as Pe,a as xe,b as _e,H as je,p as De}from"./parse.7d180a0f.js";const Ie=!0;class ce extends Error{constructor(r,s){super(r),this.name="DevalueError",this.path=s.join("")}}function ve(e){return Object(e)!==e}const Ce=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Re(e){const r=Object.getPrototypeOf(e);return r===Object.prototype||r===null||Object.getOwnPropertyNames(r).sort().join("\0")===Ce}function $e(e){return Object.prototype.toString.call(e).slice(8,-1)}function Ue(e){switch(e){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e<" "?`\\u${e.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}function re(e){let r="",s=0;const i=e.length;for(let a=0;a<i;a+=1){const o=e[a],n=Ue(o);n&&(r+=e.slice(s,a)+n,s=a+1)}return`"${s===0?e:r+e.slice(s)}"`}function Te(e,r){const s=[],i=new Map,a=[];for(const d in r)a.push({key:d,fn:r[d]});const o=[];let n=0;function f(d){if(typeof d=="function")throw new ce("Cannot stringify a function",o);if(i.has(d))return i.get(d);if(d===void 0)return Se;if(Number.isNaN(d))return Me;if(d===1/0)return Pe;if(d===-1/0)return xe;if(d===0&&1/d<0)return _e;const x=n++;i.set(d,x);for(const{key:H,fn:V}of a){const Z=V(d);if(Z)return s[x]=`["${H}",${f(Z)}]`,x}let y="";if(ve(d))y=le(d);else switch($e(d)){case"Number":case"String":case"Boolean":y=`["Object",${le(d)}]`;break;case"BigInt":y=`["BigInt",${d}]`;break;case"Date":y=`["Date","${d.toISOString()}"]`;break;case"RegExp":const{source:V,flags:Z}=d;y=Z?`["RegExp",${re(V)},"${Z}"]`:`["RegExp",${re(V)}]`;break;case"Array":y="[";for(let b=0;b<d.length;b+=1)b>0&&(y+=","),b in d?(o.push(`[${b}]`),y+=f(d[b]),o.pop()):y+=je;y+="]";break;case"Set":y='["Set"';for(const b of d)y+=`,${f(b)}`;y+="]";break;case"Map":y='["Map"';for(const[b,l]of d)o.push(`.get(${ve(b)?le(b):"..."})`),y+=`,${f(b)},${f(l)}`;y+="]";break;default:if(!Re(d))throw new ce("Cannot stringify arbitrary non-POJOs",o);if(Object.getOwnPropertySymbols(d).length>0)throw new ce("Cannot stringify POJOs with symbolic keys",o);if(Object.getPrototypeOf(d)===null){y='["null"';for(const b in d)o.push(`.${b}`),y+=`,${re(b)},${f(d[b])}`,o.pop();y+="]"}else{y="{";let b=!1;for(const l in d)b&&(y+=","),b=!0,o.push(`.${l}`),y+=`${re(l)}:${f(d[l])}`,o.pop();y+="}"}}return s[x]=y,x}const w=f(e);return w<0?`${w}`:`[${s.join(",")}]`}function le(e){const r=typeof e;return r==="string"?re(e):e instanceof String?re(e.toString()):e===void 0?Se.toString():e===0&&1/e<0?_e.toString():r==="bigint"?`["BigInt","${e}"]`:String(e)}const Ae=Ie,Le=(e,r=0)=>{const s=e.getBoundingClientRect();return s.top>=r&&s.left>=0&&s.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&s.right<=(window.innerWidth||document.documentElement.clientWidth)},Ve=(e,r=1.125,s="smooth")=>{const o=e.getBoundingClientRect().top+window.pageYOffset-window.innerHeight/(2*r);window.scrollTo({left:0,top:o,behavior:s})};class I extends Error{constructor(r){super(r),Object.setPrototypeOf(this,I.prototype)}}function be(e,r=!0){const s={},i=Object.entries(e);if(i.length===1&&i[0][0]==="_errors"&&e._errors.length)return r?e:e._errors;e._errors.length&&(s._errors=e._errors);for(const[a,o]of i.filter(([n])=>n!=="_errors"))s[a]=be(o,!1);return s}function Fe(e,r=[]){return Object.entries(e).filter(([,i])=>i!==void 0).flatMap(([i,a])=>{if(Array.isArray(a)&&a.length>0){const o=r.concat([i]);return a.map(n=>({path:o,message:n}))}else return Fe(e[i],r.concat([i]))})}function oe(e,r,s){return e[r]=s,"skip"}function Ze(e,r,s){const i=C(e,r);if(i)return s===void 0||s(i.value)?i:void 0}function C(e,r,s){if(!r.length)return;const i=[r[0]];let a=e;for(;i.length<r.length;){const n=i[i.length-1],f=s?s({parent:a,key:String(n),value:a[n],path:i.map(w=>String(w)),isLeaf:!1,set:w=>oe(a,n,w)}):a[n];if(f===void 0)return;a=f,i.push(r[i.length])}const o=r[r.length-1];return{parent:a,key:String(o),value:a[o],path:r.map(n=>String(n)),isLeaf:!0,set:n=>oe(a,o,n)}}function ae(e,r,s=[]){for(const i in e){const a=e[i],o=a===null||typeof a!="object",n={parent:e,key:i,value:a,path:s.map(String).concat([i]),isLeaf:o,set:w=>oe(e,i,w)},f=r(n);if(f==="abort")return f;if(f==="skip")continue;if(!o){const w=ae(a,r,n.path);if(w==="abort")return w}}}async function Be(e,r,s=[]){for(const i in e){const a=e[i],o=a===null||typeof a!="object",n={parent:e,key:i,value:a,path:s.map(String).concat([i]),isLeaf:o,set:w=>oe(e,i,w)},f=await r(n);if(f==="abort")return f;if(f==="skip")break;if(!o){const w=ae(a,r,n.path);if(w==="abort")return w}}}function He(e,r){const s=new Map;function i(a,o){if(a.isLeaf){const n=C(o,a.path);n?(a.value instanceof Date&&n.value instanceof Date&&a.value.getTime()!=n.value.getTime()||a.value!==n.value)&&s.set(a.path.join(" "),a.path):s.set(a.path.join(" "),a.path)}}return ae(e,a=>i(a,r)),ae(r,a=>i(a,e)),Array.from(s.values())}function ie(e,r,s){for(const i of r){const a=C(e,i,({parent:o,key:n,value:f})=>((f===void 0||typeof f!="object")&&(o[n]={}),o[n]));a&&(a.parent[a.key]=s)}}function qe(e){return Array.isArray(e)?e:[e]}function de(e,r){const s=qe(r),i=Y(e,a=>{const o=C(a,s);return o==null?void 0:o.value});return{subscribe(...a){const o=i.subscribe(...a);return()=>{o()}},update(a){e.update(o=>{const n=C(o,s);return n&&(n.parent[n.key]=a(n.value)),o})},set(a){e.update(o=>{const n=C(o,s);return n&&(n.parent[n.key]=a),o})}}}function z(e){return"structuredClone"in globalThis?structuredClone(e):De(Te(e))}function ye(e){const r=se(e);if(r.effects)return!0;const s=r.zodType._def.typeName;if(s=="ZodObject"){const i=r.zodType;for(const a of Object.values(i._def.shape()))if(ye(a))return!0}else if(s=="ZodArray"){const i=r.zodType;return ye(i.element)}return!1}function se(e){let r=!0,s=!1,i=!1,a=!1,o,n;for(;r;)e._def.typeName=="ZodNullable"?(s=!0,e=e.unwrap()):e._def.typeName=="ZodDefault"?(a=!0,n=e._def.defaultValue(),e=e._def.innerType):e._def.typeName=="ZodOptional"?(i=!0,e=e.unwrap()):e._def.typeName=="ZodEffects"?(o||(o=e),e=e._def.schema):r=!1;return{zodType:e,isNullable:s,isOptional:i,hasDefault:a,defaultValue:n,effects:o}}new TextEncoder;var D;(function(e){e[e.Idle=0]="Idle",e[e.Submitting=1]="Submitting",e[e.Delayed=2]="Delayed",e[e.Timeout=3]="Timeout"})(D||(D={}));const We={applyAction:!0,invalidateAll:!0,resetForm:!1,autoFocusOnError:"detect",scrollToError:"smooth",errorSelector:"[data-invalid]",selectErrorText:!1,stickyNavbar:void 0,taintedMessage:"Do you want to leave this page? Changes you made may not be saved.",onSubmit:void 0,onResult:void 0,onUpdate:void 0,onUpdated:void 0,onError:e=>{console.warn("Unhandled Superform error, use onError event to handle it:",e.result.error)},dataType:"form",validators:void 0,defaultValidator:"keep",clearOnSubmit:"errors-and-message",delayMs:500,timeoutMs:8e3,multipleSubmits:"prevent",validation:void 0,SPA:void 0,validateMethod:"auto"};function ze(e,r={}){{if(r={...We,...r},typeof e=="string"&&typeof r.id=="string")throw new I("You cannot specify an id both in the first superForm argument and in the options.");r.SPA&&r.validators===void 0&&console.warn("No validators set for Superform in SPA mode. Add them to the validators option, or set it to false to disable this warning.")}let s=typeof e=="string"?e:r.id??(e==null?void 0:e.id);const i=L(s),a=g(ne).form;if(a&&typeof a=="object"){for(const t of y(a).reverse())if(t.id===s){e=t;break}}!e||typeof e=="string"?e=x():H(e)===!1&&(e=x(e));const o=e,n=z(o);if(typeof n.valid!="boolean")throw new I("A non-validation object was passed to superForm. Check what's passed to its first parameter (null/undefined is allowed).");const f=L(o.errors),w={taintedMessage:r.taintedMessage,taintedFormState:z(n.data)};function d(t){w.taintedFormState=z(t)}function x(t={}){return{valid:!1,errors:{},data:t,empty:!0,constraints:{}}}function y(t){return Object.values(t).filter(u=>H(u)!==!1)}function H(t){return!t||typeof t!="object"||!("valid"in t&&"empty"in t&&typeof t.valid=="boolean")?!1:"id"in t&&typeof t.id=="string"?t.id:void 0}function V(){r.taintedMessage=w.taintedMessage}function Z(t){const u=L(t);return{subscribe:u.subscribe,set:(h,S={})=>(c(h,w.taintedFormState,S.taint??!0),w.taintedFormState=z(h),u.set(h)),update:(h,S={})=>u.update(F=>{const ue=h(F);return c(ue,w.taintedFormState,S.taint??!0),w.taintedFormState=z(F),ue})}}const b=[i.subscribe(t=>s=t)];function l(t){b.push(t)}function N(){b.forEach(t=>t())}const A=Z(o.data);function _(t,u){if(!(!u||typeof u!="object")){if(Array.isArray(u))u.length>0&&_(t,u[0]);else if(!(u instanceof Date))throw new I(`Object found in form field "${t}". Set options.dataType = 'json' and use:enhance to use nested data structures.`)}}async function k(t,u){let h=!1;const S={form:t,cancel:()=>h=!0};for(const F of M.onUpdate)await F(S);if(h){r.flashMessage&&pe(r);return}t.valid&&r.resetForm&&(r.resetForm===!0||await r.resetForm())?R(t.message):$(t,u),M.onUpdated.length&&await Ee();for(const F of M.onUpdated)F({form:t})}function R(t){$(z(n),!0,t)}const ee=async(t,u)=>{if(t.type=="error")throw new I(`ActionResult of type "${t.type}" cannot be passed to update function.`);if(t.type=="redirect"){r.resetForm&&(r.resetForm===!0||await r.resetForm())&&R();return}if(typeof t.data!="object")throw new I("Non-object validation data returned from ActionResult.");const h=y(t.data);if(!h.length)throw new I("No form data returned from ActionResult. Make sure you return { form } in the form actions.");for(const S of h)S.id===s&&await k(S,u??(t.status>=200&&t.status<300))},G=L([]),q=L(o.valid),J=L(o.empty),W=L(o.message),p=L(o.constraints),O=L(o.meta),P={subscribe:f.subscribe,set:f.set,update:f.update,clear:t=>{f.update(u=>(ae(u,h=>{if(Array.isArray(h.value))return h.set(void 0)}),t&&ie(u,[t],void 0),u))}},U=L();function Q(){return g(U)}function X(t){if(t===null)throw new I("$tainted store contained null");if(typeof t=="object"){for(const u of Object.values(t))if(X(u))return!0}return t===!0}function m(t,u){if(r.validationMethod=="onblur"||r.validationMethod=="submit-only")return;let h=r.validationMethod==="oninput";if(!h){const S=g(P),F=S?Ze(S,t):void 0;h=!!(F&&F.key in F.parent)}h&&he(t,r.validators,r.defaultValidator,A,P,U,{taint:u})}function c(t,u,h){if(h===!1)return;if(h==="untaint-all"){U.set(void 0);return}const S=He(t,u);if(h===!0&&G.set(S),S.length){U.update(F=>(F||(F={}),ie(F,S,h===!0?!0:void 0),F));for(const F of S)m(F,h)}}function v(t,u){U.set(t),d(u)}const E=L(!1),T=L(!1),j=L(!1),K=Y(P,t=>t?Fe(t):[]),te=Y(K,t=>t[0]??null);if(r.taintedMessage=void 0,ge(()=>{N();for(const t of Object.values(M))t.length=0}),r.dataType!=="json")for(const[t,u]of Object.entries(o.data))_(t,u);function $(t,u,h){if(u&&v(typeof u=="boolean"?void 0:u,t.data),h=h??t.message,A.set(t.data),W.set(h),J.set(t.empty),q.set(t.valid),P.set(t.errors),O.set(t.meta),i.set(t.id),r.flashMessage&&we(r)){const S=r.flashMessage.module.getFlash(ne);h&&g(S)===void 0&&S.set(h)}}const M={onSubmit:r.onSubmit?[r.onSubmit]:[],onResult:r.onResult?[r.onResult]:[],onUpdate:r.onUpdate?[r.onUpdate]:[],onUpdated:r.onUpdated?[r.onUpdated]:[],onError:r.onError?[r.onError]:[]};ke(t=>{if(r.taintedMessage&&!g(E)){const u=Q();u&&X(u)&&!window.confirm(r.taintedMessage)&&t.cancel()}}),r.applyAction&&l(ne.subscribe(async t=>{function u(S){throw new I(`No form data found in ${S}. Make sure you return { form } in form actions and load functions.`)}const h=t.status>=200&&t.status<300;if(t.form&&typeof t.form=="object"){const S=y(t.form);S.length||u("$page.form (ActionData)");for(const F of S)F.id===s&&await k(F,h)}else if(t.data&&typeof t.data=="object"){const S=y(t.data);for(const F of S)F.id===s&&$(F,h)}}));const B=Object.fromEntries(Object.keys(n.data).map(t=>{var u;return[t,{name:t,value:de(A,t),errors:de(P,t),constraints:de(p,t),type:(u=n.meta)==null?void 0:u.types[t]}]}));return{form:A,formId:i,errors:P,message:W,constraints:p,meta:Y(O,t=>t),fields:B,tainted:U,valid:Y(q,t=>t),empty:Y(J,t=>t),submitting:Y(E,t=>t),delayed:Y(T,t=>t),timeout:Y(j,t=>t),options:r,capture:function(){return{valid:g(q),errors:g(P),data:g(A),empty:g(J),constraints:g(p),message:g(W),id:s,meta:g(O),tainted:g(U)}},restore:function(t){return $(t,t.tainted??!0)},validate:(t,u)=>he(Array.isArray(t)?t:[t],r.validators,r.defaultValidator,A,P,U,u),enhance:(t,u)=>{if(u){if(u.onError){if(r.onError==="apply")throw new I('options.onError is set to "apply", cannot add any onError events.');if(u.onError==="apply")throw new I('Cannot add "apply" as onError event in use:enhance.');M.onError.push(u.onError)}u.onResult&&M.onResult.push(u.onResult),u.onSubmit&&M.onSubmit.push(u.onSubmit),u.onUpdate&&M.onUpdate.push(u.onUpdate),u.onUpdated&&M.onUpdated.push(u.onUpdated)}return Ye(t,E,T,j,P,ee,r,A,W,V,M,i,O,p,U,G)},firstError:te,allErrors:K,reset:t=>R(t!=null&&t.keepMessage?g(W):void 0)}}function pe(e){!e.flashMessage||!Ae||we(e)&&(document.cookie=`flash=; Max-Age=0; Path=${e.flashMessage.cookiePath??"/"};`)}function we(e){return!e.flashMessage||!Ae?!1:e.syncFlashMessage}const me=new WeakMap;async function he(e,r,s,i,a,o,n={}){n.update===void 0&&(n.update=!0),n.taint===void 0&&(n.taint=!1);const f={value:n.value,shouldUpdate:!0,currentData:void 0,validationPath:e.filter(l=>isNaN(parseInt(l)))};async function w(){s=="clear"&&b(void 0)}function d(l,N){if(N===void 0)return!1;const A=C(N,l);return A?A.value===!0:!1}function x(l,N){if(l.effects)return;const A=l.zodType;if(A._def.typeName=="ZodObject"){const _=A._def.shape()[N],k=se(_);return k.effects?void 0:k.zodType}else if(A._def.typeName=="ZodArray"){const k=se(A.element);return k.effects?void 0:x(k,N)}else throw new I("Invalid validator")}function y(){return g(a)}function H(l){a.clear(l)}function V(l){a.set(l)}function Z(l){return be(l.format())}function b(l){return typeof l=="string"&&(l=[l]),(n.update===!0||n.update=="errors")&&a.update(N=>{const A=C(N,e,_=>_.value===void 0?(_.parent[_.key]={},_.parent[_.key]):_.value);if(!A)throw new I("Error path could not be created: "+e);return A.parent[A.key]=l??void 0,N}),l??void 0}if("value"in n)n.update===!0||n.update==="value"?i.update(l=>(ie(l,[e],f.value),f.currentData=l),{taint:n.taint}):f.shouldUpdate=!1;else{f.currentData=g(i);const l=C(f.currentData,e);f.value=l==null?void 0:l.value}if(typeof r!="object")return w();if("safeParseAsync"in r){me.has(r)||me.set(r,ye(r));const N=me.get(r)?void 0:C(r,f.validationPath,_=>x(se(_.parent),_.key));if(N){const _=x(se(N.parent),N.key);if(_){if(f.currentData&&_._def.typeName=="ZodArray"&&!isNaN(parseInt(e[e.length-1]))){const R=C(f.currentData,e.slice(0,-1));f.value=R==null?void 0:R.value}const k=await _.safeParseAsync(f.value);if(k.success)return b(void 0);{const R=k.error.format();return b(R._errors)}}}f.shouldUpdate||(f.currentData=z(f.currentData??g(i)),ie(f.currentData,[e],f.value));const A=await r.safeParseAsync(f.currentData);if(A.success){H(e);return}else{const _=Z(A.error);if(n.update===!0||n.update=="errors"){const R=g(o),ee=y();let G=!1;ae(_,q=>{if(Array.isArray(q.value))return d(q.path,R)&&(ie(ee,[q.path],q.value),G=!0),"skip"}),G&&V(ee)}const k=C(_,e);return b(n.errors??(k==null?void 0:k.value))}}else{const l=C(r,f.validationPath);if(l){if(l.value===void 0)return w();{const N=l.value(f.value);return b(N&&(n.errors??N))}}else throw new I("No Superforms validator found: "+e)}}function Ye(e,r,s,i,a,o,n,f,w,d,x,y,H,V,Z,b){d();const l=a;function N(p){he(p,n.validators,n.defaultValidator,f,l,Z)}function A(p){return p&&(p instanceof HTMLSelectElement||p instanceof HTMLInputElement&&p.type=="radio")}async function _(p){if(!(n.validationMethod=="oninput"||n.validationMethod=="submit-only")){A(p.target)&&await new Promise(O=>setTimeout(O,0));for(const O of g(b))N(O);b.set([])}}e.addEventListener("focusout",_);const k=new Set;function R(p){const O=p.target;n.selectErrorText&&O.select()}function ee(p){p.querySelectorAll("input").forEach(O=>{O.addEventListener("invalid",R)})}function G(p){p.querySelectorAll("input").forEach(O=>O.removeEventListener("invalid",R))}ge(()=>{k.forEach(p=>G(p)),k.clear(),e.removeEventListener("focusout",_)});function q(p){function O(){if(n.selectErrorText){const m=U();m&&p!==m&&(G(m),k.delete(m)),k.has(p)||(ee(p),k.add(p))}P=p}let P;function U(){return P}function Q(m){return typeof n.autoFocusOnError=="boolean"?n.autoFocusOnError:!/iPhone|iPad|iPod|Android/i.test(m)}const X=async()=>{if(n.scrollToError=="off")return;const m=n.errorSelector;if(!m)return;await Ee();let c;if(c=P.querySelector(m),!c)return;c=c.querySelector(m)??c;const v=n.stickyNavbar?document.querySelector(n.stickyNavbar):null;if(Le(c,(v==null?void 0:v.offsetHeight)??0)||Ve(c,void 0,n.scrollToError),!Q(navigator.userAgent))return;let E;if(E=c,["INPUT","SELECT","BUTTON","TEXTAREA"].includes(E.tagName)||(E=E.querySelector('input:not([type="hidden"]):not(.flatpickr-input), select, textarea')),E)try{E.focus({preventScroll:!0}),n.selectErrorText&&E.tagName=="INPUT"&&E.select()}catch{}};O();{let m=D.Idle,c,v;const E=T=>{m=T,r.set(m>=D.Submitting),s.set(m>=D.Delayed),i.set(m>=D.Timeout)};return{submitting:()=>{O(),E(m!=D.Delayed?D.Submitting:D.Delayed),c&&clearTimeout(c),v&&clearTimeout(v),c=window.setTimeout(()=>{m==D.Submitting&&E(D.Delayed)},n.delayMs),v=window.setTimeout(()=>{m==D.Delayed&&E(D.Timeout)},n.timeoutMs)},completed:T=>{c&&clearTimeout(c),v&&clearTimeout(v),c=v=0,E(D.Idle),T||setTimeout(X)},scrollToFirstError:()=>setTimeout(X),isSubmitting:()=>m===D.Submitting||m===D.Delayed}}}const J=q(e);let W;return Oe(e,async p=>{var X;let O=!1;function P(){return O=!0,p.cancel()}if(J.isSubmitting()&&n.multipleSubmits=="prevent")P();else{J.isSubmitting()&&n.multipleSubmits=="abort"&&W&&W.abort(),W=p.controller;const m={...p,cancel:P};for(const c of x.onSubmit)await c(m)}if(O)n.flashMessage&&pe(n);else{if(n.validators){const m=g(f);let c,v={};if("safeParseAsync"in n.validators){const T=await n.validators.safeParseAsync(m);c=T.success,T.success||(v=be(T.error.format()))}else{c=!0;const E=n.validators,T=[];await Be(m,async({value:j,path:K})=>{const te=K.filter(M=>isNaN(parseInt(M))),$=C(E,te);if(typeof($==null?void 0:$.value)=="function"){const M=$.value;if(Array.isArray(j))for(const B in j){const t=await M(j[B]);t&&(c=!1,T.push({path:K.concat([B]),errors:typeof t=="string"?[t]:t??void 0}))}else{const B=await M(j);B&&(c=!1,T.push({path:K,errors:typeof B=="string"?[B]:B??void 0}))}}});for(const{path:j,errors:K}of T){const te=C(v,j,({parent:$,key:M,value:B})=>(B===void 0&&($[M]={}),$[M]));if(te){const{parent:$,key:M}=te;$[M]=K}}}if(!c){P();const E={valid:c,errors:v,data:m,empty:!1,constraints:g(V),message:void 0,id:g(y),meta:g(H)},T={type:"failure",status:(typeof n.SPA=="boolean"||(X=n.SPA)==null?void 0:X.failStatus)??400,data:{form:E}};setTimeout(()=>Q({result:T}),0)}}if(!O){switch(n.clearOnSubmit){case"errors-and-message":l.clear(),w.set(void 0);break;case"errors":l.clear();break;case"message":w.set(void 0);break}if(n.flashMessage&&(n.clearOnSubmit=="errors-and-message"||n.clearOnSubmit=="message")&&we(n)&&n.flashMessage.module.getFlash(ne).set(void 0),J.submitting(),n.SPA){P();const c={type:"success",status:200,data:{form:{valid:!0,errors:{},data:g(f),empty:!1,constraints:g(V),message:void 0,id:g(y),meta:g(H)}}};setTimeout(()=>Q({result:c}),0)}else if(n.dataType==="json"){const m=g(f),c=U(Te(m),n.jsonChunkSize??5e5);for(const v of c)p.data.append("__superform_json",v);Object.keys(m).forEach(v=>{typeof p.data.get(v)=="string"&&p.data.delete(v)})}}}function U(m,c){const v=Math.ceil(m.length/c),E=new Array(v);for(let T=0,j=0;T<v;++T,j+=c)E[T]=m.substring(j,j+c);return E}async function Q(m){const c=m.result;W=null;let v=!1;const E={result:c,formEl:e,cancel:()=>v=!0};for(const T of x.onResult)await T(E);if(v)n.flashMessage&&pe(n);else{if(c.type!=="error")c.type==="success"&&n.invalidateAll&&await Ne(),n.applyAction?await fe(c):await o(c);else if(n.applyAction&&(n.onError=="apply"?await fe(c):await fe({type:"failure",status:Math.floor(c.status||500)})),n.onError!=="apply"){const T={result:c,message:w};for(const j of x.onError)j!=="apply"&&await j(T)}n.flashMessage&&(c.type=="error"&&n.flashMessage.onError?await n.flashMessage.onError({result:c,message:n.flashMessage.module.getFlash(ne)}):c.type!="error"&&await n.flashMessage.module.updateFlash(ne))}J.completed(v)}return Q})}export{ze as s};

import{b as Ne,e as Oe,i as Me,a as fe}from"./forms.afd9f5f8.js";import{p as te}from"./stores.21eb68ed.js";import{d as G,w as $}from"./singletons.70ac0210.js";import{$ as g,a6 as ge,W as Ee}from"./index.0c8a5be0.js";import{U as Se,N as Pe,P as xe,a as je,b as _e,H as Ie,p as De}from"./parse.7d180a0f.js";const Re=!0;class ce extends Error{constructor(r,i){super(r),this.name="DevalueError",this.path=i.join("")}}function we(e){return Object(e)!==e}const Ce=Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function $e(e){const r=Object.getPrototypeOf(e);return r===Object.prototype||r===null||Object.getOwnPropertyNames(r).sort().join("\0")===Ce}function Ue(e){return Object.prototype.toString.call(e).slice(8,-1)}function Le(e){switch(e){case'"':return'\\"';case"<":return"\\u003C";case"\\":return"\\\\";case`
`:return"\\n";case"\r":return"\\r";case"	":return"\\t";case"\b":return"\\b";case"\f":return"\\f";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029";default:return e<" "?`\\u${e.charCodeAt(0).toString(16).padStart(4,"0")}`:""}}function ee(e){let r="",i=0;const s=e.length;for(let a=0;a<s;a+=1){const o=e[a],n=Le(o);n&&(r+=e.slice(i,a)+n,i=a+1)}return`"${i===0?e:r+e.slice(i)}"`}function Te(e,r){const i=[],s=new Map,a=[];for(const d in r)a.push({key:d,fn:r[d]});const o=[];let n=0;function f(d){if(typeof d=="function")throw new ce("Cannot stringify a function",o);if(s.has(d))return s.get(d);if(d===void 0)return Se;if(Number.isNaN(d))return Pe;if(d===1/0)return xe;if(d===-1/0)return je;if(d===0&&1/d<0)return _e;const j=n++;s.set(d,j);for(const{key:H,fn:U}of a){const L=U(d);if(L)return i[j]=`["${H}",${f(L)}]`,j}let y="";if(we(d))y=le(d);else switch(Ue(d)){case"Number":case"String":case"Boolean":y=`["Object",${le(d)}]`;break;case"BigInt":y=`["BigInt",${d}]`;break;case"Date":y=`["Date","${d.toISOString()}"]`;break;case"RegExp":const{source:U,flags:L}=d;y=L?`["RegExp",${ee(U)},"${L}"]`:`["RegExp",${ee(U)}]`;break;case"Array":y="[";for(let b=0;b<d.length;b+=1)b>0&&(y+=","),b in d?(o.push(`[${b}]`),y+=f(d[b]),o.pop()):y+=Ie;y+="]";break;case"Set":y='["Set"';for(const b of d)y+=`,${f(b)}`;y+="]";break;case"Map":y='["Map"';for(const[b,l]of d)o.push(`.get(${we(b)?le(b):"..."})`),y+=`,${f(b)},${f(l)}`;y+="]";break;default:if(!$e(d))throw new ce("Cannot stringify arbitrary non-POJOs",o);if(Object.getOwnPropertySymbols(d).length>0)throw new ce("Cannot stringify POJOs with symbolic keys",o);if(Object.getPrototypeOf(d)===null){y='["null"';for(const b in d)o.push(`.${b}`),y+=`,${ee(b)},${f(d[b])}`,o.pop();y+="]"}else{y="{";let b=!1;for(const l in d)b&&(y+=","),b=!0,o.push(`.${l}`),y+=`${ee(l)}:${f(d[l])}`,o.pop();y+="}"}}return i[j]=y,j}const w=f(e);return w<0?`${w}`:`[${i.join(",")}]`}function le(e){const r=typeof e;return r==="string"?ee(e):e instanceof String?ee(e.toString()):e===void 0?Se.toString():e===0&&1/e<0?_e.toString():r==="bigint"?`["BigInt","${e}"]`:String(e)}const Ae=Re,Ve=(e,r=0)=>{const i=e.getBoundingClientRect();return i.top>=r&&i.left>=0&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)},Ze=(e,r=1.125,i="smooth")=>{const o=e.getBoundingClientRect().top+window.pageYOffset-window.innerHeight/(2*r);window.scrollTo({left:0,top:o,behavior:i})};class R extends Error{constructor(r){super(r),Object.setPrototypeOf(this,R.prototype)}}function he(e,r=!0){const i={},s=Object.entries(e);if(s.length===1&&s[0][0]==="_errors"&&e._errors.length)return r?e:e._errors;e._errors.length&&(i._errors=e._errors);for(const[a,o]of s.filter(([n])=>n!=="_errors"))i[a]=he(o,!1);return i}function Fe(e,r=[]){return Object.entries(e).filter(([,s])=>s!==void 0).flatMap(([s,a])=>{if(Array.isArray(a)&&a.length>0){const o=r.concat([s]);return a.map(n=>({path:o,message:n}))}else return Fe(e[s],r.concat([s]))})}function oe(e,r,i){return e[r]=i,"skip"}function Be(e,r,i){const s=C(e,r);if(s)return i===void 0||i(s.value)?s:void 0}function C(e,r,i){if(!r.length)return;const s=[r[0]];let a=e;for(;s.length<r.length;){const n=s[s.length-1],f=i?i({parent:a,key:String(n),value:a[n],path:s.map(w=>String(w)),isLeaf:!1,set:w=>oe(a,n,w)}):a[n];if(f===void 0)return;a=f,s.push(r[s.length])}const o=r[r.length-1];return{parent:a,key:String(o),value:a[o],path:r.map(n=>String(n)),isLeaf:!0,set:n=>oe(a,o,n)}}function re(e,r,i=[]){for(const s in e){const a=e[s],o=a===null||typeof a!="object",n={parent:e,key:s,value:a,path:i.map(String).concat([s]),isLeaf:o,set:w=>oe(e,s,w)},f=r(n);if(f==="abort")return f;if(f==="skip")continue;if(!o){const w=re(a,r,n.path);if(w==="abort")return w}}}async function He(e,r,i=[]){for(const s in e){const a=e[s],o=a===null||typeof a!="object",n={parent:e,key:s,value:a,path:i.map(String).concat([s]),isLeaf:o,set:w=>oe(e,s,w)},f=await r(n);if(f==="abort")return f;if(f==="skip")break;if(!o){const w=re(a,r,n.path);if(w==="abort")return w}}}function qe(e,r){const i=new Map;function s(a,o){if(a.isLeaf){const n=C(o,a.path);n?(a.value instanceof Date&&n.value instanceof Date&&a.value.getTime()!=n.value.getTime()||a.value!==n.value)&&i.set(a.path.join(" "),a.path):i.set(a.path.join(" "),a.path)}}return re(e,a=>s(a,r)),re(r,a=>s(a,e)),Array.from(i.values())}function ie(e,r,i){for(const s of r){const a=C(e,s,({parent:o,key:n,value:f})=>((f===void 0||typeof f!="object")&&(o[n]={}),o[n]));a&&(a.parent[a.key]=i)}}function We(e){return Array.isArray(e)?e:[e]}function de(e,r){const i=We(r),s=G(e,a=>{const o=C(a,i);return o==null?void 0:o.value});return{subscribe(...a){const o=s.subscribe(...a);return()=>{o()}},update(a){e.update(o=>{const n=C(o,i);return n&&(n.parent[n.key]=a(n.value)),o})},set(a){e.update(o=>{const n=C(o,i);return n&&(n.parent[n.key]=a),o})}}}function z(e){return"structuredClone"in globalThis?structuredClone(e):De(Te(e))}function ye(e){const r=se(e);if(r.effects)return!0;const i=r.zodType._def.typeName;if(i=="ZodObject"){const s=r.zodType;for(const a of Object.values(s._def.shape()))if(ye(a))return!0}else if(i=="ZodArray"){const s=r.zodType;return ye(s.element)}return!1}function se(e){let r=!0,i=!1,s=!1,a=!1,o,n;for(;r;)e._def.typeName=="ZodNullable"?(i=!0,e=e.unwrap()):e._def.typeName=="ZodDefault"?(a=!0,n=e._def.defaultValue(),e=e._def.innerType):e._def.typeName=="ZodOptional"?(s=!0,e=e.unwrap()):e._def.typeName=="ZodEffects"?(o||(o=e),e=e._def.schema):r=!1;return{zodType:e,isNullable:i,isOptional:s,hasDefault:a,defaultValue:n,effects:o}}new TextEncoder;var D;(function(e){e[e.Idle=0]="Idle",e[e.Submitting=1]="Submitting",e[e.Delayed=2]="Delayed",e[e.Timeout=3]="Timeout"})(D||(D={}));const Ye={applyAction:!0,invalidateAll:!0,resetForm:!1,autoFocusOnError:"detect",scrollToError:"smooth",errorSelector:"[data-invalid]",selectErrorText:!1,stickyNavbar:void 0,taintedMessage:"Do you want to leave this page? Changes you made may not be saved.",onSubmit:void 0,onResult:void 0,onUpdate:void 0,onUpdated:void 0,onError:e=>{console.warn("Unhandled Superform error, use onError event to handle it:",e.result.error)},dataType:"form",validators:void 0,defaultValidator:"keep",clearOnSubmit:"errors-and-message",delayMs:500,timeoutMs:8e3,multipleSubmits:"prevent",validation:void 0,SPA:void 0,validateMethod:"auto"};function et(e,r={}){{if(r={...Ye,...r},typeof e=="string"&&typeof r.id=="string")throw new R("You cannot specify an id both in the first superForm argument and in the options.");r.SPA&&r.validators===void 0&&console.warn("No validators set for Superform in SPA mode. Add them to the validators option, or set it to false to disable this warning.")}let i=typeof e=="string"?e:r.id??(e==null?void 0:e.id);const s=$(i),a=g(te).form;if(a&&typeof a=="object"){for(const t of y(a).reverse())if(t.id===i){e=t;break}}!e||typeof e=="string"?e=j():H(e)===!1&&(e=j(e));const o=e,n=z(o);if(typeof n.valid!="boolean")throw new R("A non-validation object was passed to superForm. Check what's passed to its first parameter (null/undefined is allowed).");const f=$(o.errors),w={taintedMessage:r.taintedMessage,taintedFormState:z(n.data)};function d(t){w.taintedFormState=z(t)}function j(t={}){return{valid:!1,errors:{},data:t,empty:!0,constraints:{}}}function y(t){return Object.values(t).filter(u=>H(u)!==!1)}function H(t){return!t||typeof t!="object"||!("valid"in t&&"empty"in t&&typeof t.valid=="boolean")?!1:"id"in t&&typeof t.id=="string"?t.id:void 0}function U(){r.taintedMessage=w.taintedMessage}function L(t){const u=$(t);return{subscribe:u.subscribe,set:(v,F={})=>(m(v,w.taintedFormState,F.taint??!0),w.taintedFormState=z(v),u.set(v)),update:(v,F={})=>u.update(M=>{const ue=v(M);return m(ue,w.taintedFormState,F.taint??!0),w.taintedFormState=z(M),ue})}}const b=[s.subscribe(t=>i=t)];function l(t){b.push(t)}function k(){b.forEach(t=>t())}const T=L(o.data);function A(t,u){if(!(!u||typeof u!="object")){if(Array.isArray(u))u.length>0&&A(t,u[0]);else if(!(u instanceof Date))throw new R(`Object found in form field "${t}". Set options.dataType = 'json' and use:enhance to use nested data structures.`)}}async function P(t,u){t.valid&&r.resetForm&&(r.resetForm===!0||await r.resetForm())?I(t.message):Z(t,u),O.onUpdated.length&&await Ee();for(const v of O.onUpdated)v({form:t})}function I(t){Z(z(n),!0,t)}const X=async(t,u)=>{if(t.type=="error")throw new R(`ActionResult of type "${t.type}" cannot be passed to update function.`);if(t.type=="redirect"){r.resetForm&&(r.resetForm===!0||await r.resetForm())&&I();return}if(typeof t.data!="object")throw new R("Non-object validation data returned from ActionResult.");const v=y(t.data);if(!v.length)throw new R("No form data returned from ActionResult. Make sure you return { form } in the form actions.");for(const F of v)F.id===i&&await P(F,u??(t.status>=200&&t.status<300))},K=$([]),V=$(o.valid),ne=$(o.empty),q=$(o.message),W=$(o.constraints),p=$(o.meta),S={subscribe:f.subscribe,set:f.set,update:f.update,clear:()=>ke(f,{undefinePath:null,clearFormLevelErrors:!0})},x=$();function ae(){return g(x)}function J(t){if(t===null)throw new R("$tainted store contained null");if(typeof t=="object"){for(const u of Object.values(t))if(J(u))return!0}return t===!0}function Q(t,u){if(r.validationMethod=="onblur"||r.validationMethod=="submit-only")return;let v=r.validationMethod==="oninput";if(!v){const F=g(S),M=F?Be(F,t):void 0;v=!!(M&&M.key in M.parent)}v&&pe(t,r.validators,r.defaultValidator,T,S,x,{taint:u})}function m(t,u,v){if(v===!1)return;if(v==="untaint-all"){x.set(void 0);return}const F=qe(t,u);if(v===!0&&K.set(F),F.length){x.update(M=>(M||(M={}),ie(M,F,v===!0?!0:void 0),M));for(const M of F)Q(M,v)}}function c(t,u){x.set(t),d(u)}const h=$(!1),_=$(!1),E=$(!1),N=G(S,t=>t?Fe(t):[]),Y=G(N,t=>t[0]??null);if(r.taintedMessage=void 0,ge(()=>{k();for(const t of Object.values(O))t.length=0}),r.dataType!=="json")for(const[t,u]of Object.entries(o.data))A(t,u);function Z(t,u,v){if(u&&c(typeof u=="boolean"?void 0:u,t.data),v=v??t.message,T.set(t.data),q.set(v),ne.set(t.empty),V.set(t.valid),S.set(t.errors),p.set(t.meta),s.set(t.id),r.flashMessage&&be(r)){const F=r.flashMessage.module.getFlash(te);v&&g(F)===void 0&&F.set(v)}}const O={onSubmit:r.onSubmit?[r.onSubmit]:[],onResult:r.onResult?[r.onResult]:[],onUpdate:r.onUpdate?[r.onUpdate]:[],onUpdated:r.onUpdated?[r.onUpdated]:[],onError:r.onError?[r.onError]:[]};Ne(t=>{if(r.taintedMessage&&!g(h)){const u=ae();u&&J(u)&&!window.confirm(r.taintedMessage)&&t.cancel()}}),l(te.subscribe(async t=>{if(!r.applyAction)return;function u(F){throw new R(`No form data found in ${F}. Make sure you return { form } in form actions and load functions.`)}const v=t.status>=200&&t.status<300;if(t.form&&typeof t.form=="object"){const F=y(t.form);F.length||u("$page.form (ActionData)");for(const M of F)M.id===i&&await P(M,v)}else if(t.data&&typeof t.data=="object"){const F=y(t.data);for(const M of F)M.id===i&&Z(M,v)}}));const B=Object.fromEntries(Object.keys(n.data).map(t=>{var u;return[t,{name:t,value:de(T,t),errors:de(S,t),constraints:de(W,t),type:(u=n.meta)==null?void 0:u.types[t]}]}));return{form:T,formId:s,errors:S,message:q,constraints:W,meta:G(p,t=>t),fields:B,tainted:x,valid:G(V,t=>t),empty:G(ne,t=>t),submitting:G(h,t=>t),delayed:G(_,t=>t),timeout:G(E,t=>t),options:r,capture:function(){return{valid:g(V),errors:g(S),data:g(T),empty:g(ne),constraints:g(W),message:g(q),id:i,meta:g(p),tainted:g(x)}},restore:function(t){return Z(t,t.tainted??!0)},validate:(t,u)=>pe(Array.isArray(t)?t:[t],r.validators,r.defaultValidator,T,S,x,u),enhance:(t,u)=>{if(u){if(u.onError){if(r.onError==="apply")throw new R('options.onError is set to "apply", cannot add any onError events.');if(u.onError==="apply")throw new R('Cannot add "apply" as onError event in use:enhance.');O.onError.push(u.onError)}u.onResult&&O.onResult.push(u.onResult),u.onSubmit&&O.onSubmit.push(u.onSubmit),u.onUpdate&&O.onUpdate.push(u.onUpdate),u.onUpdated&&O.onUpdated.push(u.onUpdated)}return Ge(t,h,_,E,S,X,r,T,q,U,O,s,p,W,x,K,y)},firstError:Y,allErrors:N,reset:t=>I(t!=null&&t.keepMessage?g(q):void 0)}}function ve(e){!e.flashMessage||!Ae||be(e)&&(document.cookie=`flash=; Max-Age=0; Path=${e.flashMessage.cookiePath??"/"};`)}function be(e){return!e.flashMessage||!Ae?!1:e.syncFlashMessage}function ke(e,r){e.update(i=>(re(i,s=>{if(!(s.path.length==1&&s.path[0]=="_errors"&&!r.clearFormLevelErrors)&&Array.isArray(s.value))return s.set(void 0)}),r.undefinePath&&ie(i,[r.undefinePath],void 0),i))}const me=new WeakMap;async function pe(e,r,i,s,a,o,n={}){n.update===void 0&&(n.update=!0),n.taint===void 0&&(n.taint=!1);const f={value:n.value,shouldUpdate:!0,currentData:void 0,validationPath:e.filter(l=>isNaN(parseInt(l)))};async function w(){i=="clear"&&b(void 0)}function d(l,k){if(k===void 0)return!1;const T=C(k,l);return T?T.value===!0:!1}function j(l,k){if(l.effects)return;const T=l.zodType;if(T._def.typeName=="ZodObject"){const A=T._def.shape()[k],P=se(A);return P.effects?void 0:P.zodType}else if(T._def.typeName=="ZodArray"){const P=se(T.element);return P.effects?void 0:j(P,k)}else throw new R("Invalid validator")}function y(){return g(a)}function H(l){return ke(a,l)}function U(l){a.set(l)}function L(l){return he(l.format())}function b(l){return typeof l=="string"&&(l=[l]),(n.update===!0||n.update=="errors")&&a.update(k=>{const T=C(k,e,A=>A.value===void 0?(A.parent[A.key]={},A.parent[A.key]):A.value);if(!T)throw new R("Error path could not be created: "+e);return T.parent[T.key]=l??void 0,k}),l??void 0}if("value"in n)n.update===!0||n.update==="value"?s.update(l=>(ie(l,[e],f.value),f.currentData=l),{taint:n.taint}):f.shouldUpdate=!1;else{f.currentData=g(s);const l=C(f.currentData,e);f.value=l==null?void 0:l.value}if(typeof r!="object")return w();if("safeParseAsync"in r){me.has(r)||me.set(r,ye(r));const k=me.get(r)?void 0:C(r,f.validationPath,A=>j(se(A.parent),A.key));if(k){const A=j(se(k.parent),k.key);if(A){if(f.currentData&&A._def.typeName=="ZodArray"&&!isNaN(parseInt(e[e.length-1]))){const I=C(f.currentData,e.slice(0,-1));f.value=I==null?void 0:I.value}const P=await A.safeParseAsync(f.value);if(P.success)return b(void 0);{const I=P.error.format();return b(I._errors)}}}f.shouldUpdate||(f.currentData=z(f.currentData??g(s)),ie(f.currentData,[e],f.value));const T=await r.safeParseAsync(f.currentData);if(T.success){H({undefinePath:e,clearFormLevelErrors:!1});return}else{const A=L(T.error);if(n.update===!0||n.update=="errors"){const I=g(o),X=y();let K=!1;re(A,V=>{if(Array.isArray(V.value))return d(V.path,I)&&(ie(X,[V.path],V.value),K=!0),"skip"}),K&&U(X)}const P=C(A,e);return b(n.errors??(P==null?void 0:P.value))}}else{const l=C(r,f.validationPath);if(l){if(l.value===void 0)return w();{const k=l.value(f.value);return b(k&&(n.errors??k))}}else throw new R("No Superforms validator found: "+e)}}function Ge(e,r,i,s,a,o,n,f,w,d,j,y,H,U,L,b,l){d();const k=a;function T(p){pe(p,n.validators,n.defaultValidator,f,k,L)}function A(p){return p&&(p instanceof HTMLSelectElement||p instanceof HTMLInputElement&&p.type=="radio")}async function P(p){if(!(n.validationMethod=="oninput"||n.validationMethod=="submit-only")){A(p.target)&&await new Promise(S=>setTimeout(S,0));for(const S of g(b))T(S);b.set([])}}e.addEventListener("focusout",P);const I=new Set;function X(p){const S=p.target;n.selectErrorText&&S.select()}function K(p){p.querySelectorAll("input").forEach(S=>{S.addEventListener("invalid",X)})}function V(p){p.querySelectorAll("input").forEach(S=>S.removeEventListener("invalid",X))}ge(()=>{I.forEach(p=>V(p)),I.clear(),e.removeEventListener("focusout",P)});function ne(p){function S(){if(n.selectErrorText){const m=ae();m&&p!==m&&(V(m),I.delete(m)),I.has(p)||(K(p),I.add(p))}x=p}let x;function ae(){return x}function J(m){return typeof n.autoFocusOnError=="boolean"?n.autoFocusOnError:!/iPhone|iPad|iPod|Android/i.test(m)}const Q=async()=>{if(n.scrollToError=="off")return;const m=n.errorSelector;if(!m)return;await Ee();let c;if(c=x.querySelector(m),!c)return;c=c.querySelector(m)??c;const h=n.stickyNavbar?document.querySelector(n.stickyNavbar):null;if(Ve(c,(h==null?void 0:h.offsetHeight)??0)||Ze(c,void 0,n.scrollToError),!J(navigator.userAgent))return;let _;if(_=c,["INPUT","SELECT","BUTTON","TEXTAREA"].includes(_.tagName)||(_=_.querySelector('input:not([type="hidden"]):not(.flatpickr-input), select, textarea')),_)try{_.focus({preventScroll:!0}),n.selectErrorText&&_.tagName=="INPUT"&&_.select()}catch{}};S();{let m=D.Idle,c,h;const _=E=>{m=E,r.set(m>=D.Submitting),i.set(m>=D.Delayed),s.set(m>=D.Timeout)};return{submitting:()=>{S(),_(m!=D.Delayed?D.Submitting:D.Delayed),c&&clearTimeout(c),h&&clearTimeout(h),c=window.setTimeout(()=>{m==D.Submitting&&_(D.Delayed)},n.delayMs),h=window.setTimeout(()=>{m==D.Delayed&&_(D.Timeout)},n.timeoutMs)},completed:E=>{c&&clearTimeout(c),h&&clearTimeout(h),c=h=0,_(D.Idle),E||setTimeout(Q)},scrollToFirstError:()=>setTimeout(Q),isSubmitting:()=>m===D.Submitting||m===D.Delayed}}}const q=ne(e);let W;return Oe(e,async p=>{var Q;let S=!1;function x(){return S=!0,p.cancel()}if(q.isSubmitting()&&n.multipleSubmits=="prevent")x();else{q.isSubmitting()&&n.multipleSubmits=="abort"&&W&&W.abort(),W=p.controller;const m={...p,cancel:x};for(const c of j.onSubmit)await c(m)}if(S)n.flashMessage&&ve(n);else{if(n.validators){const m=g(f);let c,h={};if("safeParseAsync"in n.validators){const E=await n.validators.safeParseAsync(m);c=E.success,E.success||(h=he(E.error.format()))}else{c=!0;const _=n.validators,E=[];await He(m,async({value:N,path:Y})=>{const Z=Y.filter(B=>isNaN(parseInt(B))),O=C(_,Z);if(typeof(O==null?void 0:O.value)=="function"){const B=O.value;if(Array.isArray(N))for(const t in N){const u=await B(N[t]);u&&(c=!1,E.push({path:Y.concat([t]),errors:typeof u=="string"?[u]:u??void 0}))}else{const t=await B(N);t&&(c=!1,E.push({path:Y,errors:typeof t=="string"?[t]:t??void 0}))}}});for(const{path:N,errors:Y}of E){const Z=C(h,N,({parent:O,key:B,value:t})=>(t===void 0&&(O[B]={}),O[B]));if(Z){const{parent:O,key:B}=Z;O[B]=Y}}}if(!c){x();const _={valid:c,errors:h,data:m,empty:!1,constraints:g(U),message:void 0,id:g(y),meta:g(H)},E={type:"failure",status:(typeof n.SPA=="boolean"||(Q=n.SPA)==null?void 0:Q.failStatus)??400,data:{form:_}};setTimeout(()=>J({result:E}),0)}}if(!S){switch(n.clearOnSubmit){case"errors-and-message":k.clear(),w.set(void 0);break;case"errors":k.clear();break;case"message":w.set(void 0);break}if(n.flashMessage&&(n.clearOnSubmit=="errors-and-message"||n.clearOnSubmit=="message")&&be(n)&&n.flashMessage.module.getFlash(te).set(void 0),q.submitting(),n.SPA){x();const c={type:"success",status:200,data:{form:{valid:!0,errors:{},data:g(f),empty:!1,constraints:g(U),message:void 0,id:g(y),meta:g(H)}}};setTimeout(()=>J({result:c}),0)}else if(n.dataType==="json"){const m=g(f),c=ae(Te(m),n.jsonChunkSize??5e5);for(const h of c)p.data.append("__superform_json",h);Object.keys(m).forEach(h=>{typeof p.data.get(h)=="string"&&p.data.delete(h)})}}}function ae(m,c){const h=Math.ceil(m.length/c),_=new Array(h);for(let E=0,N=0;E<h;++E,N+=c)_[E]=m.substring(N,N+c);return _}async function J(m){const c=m.result;W=null;let h=!1;const _={result:c,formEl:e,cancel:()=>h=!0};for(const E of j.onResult)await E(_);if(!h){if((c.type==="success"||c.type=="failure")&&c.data){const E=l(c.data);if(!E.length)throw new R("No form data returned from ActionResult. Make sure you return { form } in the form actions.");for(const N of E){if(N.id!==g(y))continue;const Y={form:N,formEl:e,cancel:()=>h=!0};for(const Z of j.onUpdate)await Z(Y)}}if(!h){if(c.type!=="error")c.type==="success"&&n.invalidateAll&&await Me(),n.applyAction?await fe(c):await o(c);else if(n.applyAction&&(n.onError=="apply"?await fe(c):await fe({type:"failure",status:Math.floor(c.status||500)})),n.onError!=="apply"){const E={result:c,message:w};for(const N of j.onError)N!=="apply"&&await N(E)}n.flashMessage&&(c.type=="error"&&n.flashMessage.onError?await n.flashMessage.onError({result:c,message:n.flashMessage.module.getFlash(te)}):c.type!="error"&&await n.flashMessage.module.updateFlash(te))}}h&&n.flashMessage&&ve(n),q.completed(h)}return J})}export{et as s};
